<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <title>7penis.net</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />
</head>
<body style="margin:0;background:black;display:flex;align-items:center;justify-content:center;">
  <img id="hero" alt="" style="max-width:100%;max-height:100vh;" />

  <script>
    const BASE = "7penisdotnet";

    // Try multiple extensions + cases (GitHub Pages is case-sensitive)
    const EXTS = [".jpg", ".JPG", ".jpeg", ".JPEG", ".png", ".PNG", ".webp", ".WEBP"];

    const MAX = 9999;              // highest number to try
    const MISS_STREAK_LIMIT = 15;  // stop after this many consecutive misses
    const MAX_FOUND = 100;         // cap list size for speed

    const found = [];

    function exists(src) {
      return new Promise(resolve => {
        const img = new Image();
        img.onload = () => resolve(true);
        img.onerror = () => resolve(false);
        img.src = src;
      });
    }

    async function firstExisting(candidates) {
      for (const c of candidates) {
        if (await exists(c)) return c;
      }
      return null;
    }

    function pickRandom(arr, avoid) {
      if (arr.length === 1) return arr[0];
      let pick = arr[Math.floor(Math.random() * arr.length)];
      if (avoid && pick === avoid) {
        pick = arr[(arr.indexOf(pick) + 1) % arr.length];
      }
      return pick;
    }

    async function preload(src) {
      return new Promise(resolve => {
        const img = new Image();
        img.onload = () => resolve(true);
        img.onerror = () => resolve(false);
        img.src = src;
      });
    }

    async function discoverAndShowQuickly() {
      const hero = document.getElementById("hero");

      // 1) Try base file with no number: 7penisdotnet.jpg / .JPG / etc
      {
        const candidates = EXTS.map(ext => `${BASE}${ext}`);
        const hit = await firstExisting(candidates);
        if (hit) {
          found.push(hit);
          // show immediately if nothing is showing yet
          if (!hero.src) hero.src = hit;
        }
      }

      // 2) Try numbered files: 7penisdotnet1.jpg, 2, 3...
      let missStreak = 0;

      for (let i = 1; i <= MAX && found.length < MAX_FOUND; i++) {
        const candidates = EXTS.map(ext => `${BASE}${i}${ext}`);
        const hit = await firstExisting(candidates);

        if (hit) {
          found.push(hit);
          missStreak = 0;

          // show the first numbered hit ASAP if we still haven't displayed anything
          if (!document.getElementById("hero").src) {
            document.getElementById("hero").src = hit;
          }
        } else {
          missStreak++;
          if (missStreak >= MISS_STREAK_LIMIT) break; // stop scanning forever
        }
      }
    }

    async function main() {
      const hero = document.getElementById("hero");

      await discoverAndShowQuickly();

      if (found.length === 0) {
        console.error("No images found. Check filenames + extensions/case.");
        // Optional: show something visible instead of blank
        hero.alt = "No images found.";
        return;
      }

      const lastShown = sessionStorage.getItem("lastShown") || "";
      const cachedNext = sessionStorage.getItem("nextImage") || "";

      // Use preloaded "next" if valid, otherwise random
      const current = (cachedNext && found.includes(cachedNext))
        ? cachedNext
        : pickRandom(found, lastShown);

      hero.src = current;
      sessionStorage.setItem("lastShown", current);

      // Preload next for faster reload feel
      const next = pickRandom(found, current);
      preload(next); // don't await; keep page snappy
      sessionStorage.setItem("nextImage", next);
    }

    main();
  </script>
</body>
</html>
